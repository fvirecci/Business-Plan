<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Griglia di Valutazione - FSC Turismo Sicilia 2021-2027</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.95;
        }

        .score-display {
            background: rgba(255,255,255,0.2);
            padding: 20px;
            border-radius: 15px;
            margin-top: 20px;
        }

        .score-display h2 {
            font-size: 3em;
            margin: 10px 0;
        }

        .content {
            padding: 40px;
        }

        .regime-selector {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .regime-selector h2 {
            color: white;
            margin-bottom: 20px;
            font-size: 1.8em;
        }

        .regime-buttons {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .regime-buttons label {
            flex: 1;
            min-width: 200px;
        }

        .regime-buttons input[type="radio"] {
            display: none;
        }

        .regime-buttons label span {
            display: block;
            padding: 20px;
            background: white;
            border-radius: 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: bold;
            color: #764ba2;
            border: 3px solid transparent;
        }

        .regime-buttons input[type="radio"]:checked + span {
            background: #764ba2;
            color: white;
            border-color: white;
            transform: scale(1.05);
            box-shadow: 0 5px 20px rgba(0,0,0,0.2);
        }

        .regime-buttons label span:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .stato-impresa {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .stato-impresa h3 {
            color: white;
            margin-bottom: 15px;
            font-size: 1.5em;
        }

        .stato-buttons {
            display: flex;
            gap: 15px;
        }

        .stato-buttons label {
            flex: 1;
        }

        .stato-buttons input[type="radio"] {
            display: none;
        }

        .stato-buttons label span {
            display: block;
            padding: 15px;
            background: white;
            border-radius: 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: bold;
            color: #00f2fe;
            border: 3px solid transparent;
        }

        .stato-buttons input[type="radio"]:checked + span {
            background: #0077be;
            color: white;
            border-color: white;
            transform: scale(1.05);
        }

        .criterion {
            background: #f8f9fa;
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 25px;
            border-left: 5px solid #667eea;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
            transition: all 0.3s ease;
        }

        .criterion:hover {
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
            transform: translateY(-2px);
        }

        .criterion-header {
            margin-bottom: 20px;
        }

        .criterion-header h3 {
            color: #667eea;
            font-size: 1.5em;
            margin-bottom: 10px;
        }

        .criterion-header .max-points {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 8px 15px;
            border-radius: 20px;
            display: inline-block;
            font-weight: bold;
            font-size: 0.9em;
        }

        .criterion-score {
            float: right;
            background: #28a745;
            color: white;
            padding: 10px 20px;
            border-radius: 25px;
            font-weight: bold;
            font-size: 1.2em;
            box-shadow: 0 4px 10px rgba(40, 167, 69, 0.3);
        }

        .input-group {
            margin-bottom: 20px;
        }

        .input-group label {
            display: block;
            margin-bottom: 8px;
            color: #495057;
            font-weight: 600;
        }

        .input-group input[type="number"] {
            width: 100%;
            padding: 12px;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            font-size: 1em;
            transition: all 0.3s ease;
        }

        .input-group input[type="number"]:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .option-group {
            margin-bottom: 15px;
        }

        .option-group label {
            display: block;
            padding: 15px;
            background: white;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .option-group label:hover {
            background: #f0f0f0;
            border-color: #667eea;
        }

        .option-group input[type="radio"]:checked + label,
        .option-group label:has(input[type="radio"]:checked) {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-color: #667eea;
        }

        .option-group input[type="radio"] {
            margin-right: 10px;
        }

        .checkbox-group {
            margin-bottom: 15px;
        }

        .checkbox-group label {
            display: block;
            padding: 12px;
            background: white;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .checkbox-group label:hover {
            background: #f0f0f0;
            border-color: #28a745;
        }

        .checkbox-group input[type="checkbox"]:checked + label,
        .checkbox-group label:has(input[type="checkbox"]:checked) {
            background: #28a745;
            color: white;
            border-color: #28a745;
        }

        .checkbox-group input[type="checkbox"] {
            margin-right: 10px;
        }

        .sub-criterion {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 15px;
            border-left: 3px solid #28a745;
        }

        .sub-criterion h4 {
            color: #28a745;
            margin-bottom: 15px;
            font-size: 1.2em;
        }

        .alert {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            color: #856404;
        }

        .alert-info {
            background: #d1ecf1;
            border-left-color: #17a2b8;
            color: #0c5460;
        }

        .footer {
            background: #f8f9fa;
            padding: 30px;
            text-align: center;
            color: #6c757d;
            border-top: 3px solid #667eea;
        }

        .reset-button {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 25px;
            font-size: 1.1em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(245, 87, 108, 0.3);
            margin-top: 20px;
        }

        .reset-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(245, 87, 108, 0.4);
        }

        .disabled {
            opacity: 0.5;
            pointer-events: none;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.8em;
            }
            
            .regime-buttons {
                flex-direction: column;
            }
            
            .content {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üè® Griglia di Valutazione</h1>
            <p>FSC 2021-2027 - Agevolazioni Settore Turistico Alberghiero ed Extra-alberghiero</p>
            <div class="score-display">
                <p>Punteggio Totale</p>
                <h2 id="totalScore">0 / 100</h2>
            </div>
        </div>

        <div class="content">
            <!-- Selezione Regime di Aiuto -->
            <div class="regime-selector">
                <h2>üìã Seleziona il Regime di Aiuto</h2>
                <div class="regime-buttons">
                    <label>
                        <input type="radio" name="regime" value="deminimis" onchange="aggiornaVisibilitaCriteri()">
                        <span>De Minimis<br>(Reg. UE 2831/2023)</span>
                    </label>
                    <label>
                        <input type="radio" name="regime" value="esenzione" onchange="aggiornaVisibilitaCriteri()">
                        <span>Esenzione<br>(Reg. UE 651/2014)</span>
                    </label>
                </div>
            </div>

            <div class="alert alert-info">
                <strong>‚ÑπÔ∏è Nota:</strong> Seleziona prima il regime di aiuto per visualizzare i criteri applicabili.
            </div>

            <!-- Criterio A: Impatto Occupazionale -->
            <div class="criterion" id="criterionA" style="display:none;">
                <div class="criterion-header">
                    <h3>A) Rapporto Costo Investimento / Occupazione Generata</h3>
                    <span class="max-points">Max 20 punti</span>
                    <span class="criterion-score" id="scoreA">0 punti</span>
                </div>

                <div class="stato-impresa">
                    <h3>Stato dell'impresa</h3>
                    <div class="stato-buttons">
                        <label>
                            <input type="radio" name="statoImpresaA" value="inattiva" onchange="aggiornaVisibilitaSottocriteri(); calcolaPunteggio();">
                            <span>Impresa Inattiva</span>
                        </label>
                        <label>
                            <input type="radio" name="statoImpresaA" value="attiva" onchange="aggiornaVisibilitaSottocriteri(); calcolaPunteggio();">
                            <span>Impresa Attiva</span>
                        </label>
                    </div>
                </div>

                <div id="aInattiva" style="display:none;">
                    <div class="input-group">
                        <label>Nuovi occupati ULA all'anno a regime:</label>
                        <input type="number" id="aInattivaNuoviOccupati" step="0.1" min="0" onchange="calcolaPunteggio()">
                    </div>
                    <div class="input-group">
                        <label>Investimento totale (‚Ç¨):</label>
                        <input type="number" id="aInattivaInvestimento" step="1000" min="0" onchange="calcolaPunteggio()">
                    </div>
                </div>

                <div id="aAttiva" style="display:none;">
                    <div class="input-group">
                        <label>Incremento occupati ULA (anno a regime - anno precedente):</label>
                        <input type="number" id="aAttivaIncrementoOccupati" step="0.1" min="0" onchange="calcolaPunteggio()">
                    </div>
                    <div class="input-group">
                        <label>Investimento totale (‚Ç¨):</label>
                        <input type="number" id="aAttivaInvestimento" step="1000" min="0" onchange="calcolaPunteggio()">
                    </div>
                </div>
            </div>

            <!-- Criterio B: Investimento Operativo -->
            <div class="criterion" id="criterionB" style="display:none;">
                <div class="criterion-header">
                    <h3>B) Rapporto Investimento / Immobilizzazioni</h3>
                    <span class="max-points">Max 20 punti</span>
                    <span class="criterion-score" id="scoreB">0 punti</span>
                </div>

                <div class="input-group">
                    <label>Costo investimento complessivo (‚Ç¨):</label>
                    <input type="number" id="bInvestimentoTotale" step="1000" min="0" onchange="calcolaPunteggio()">
                </div>
                <div class="input-group">
                    <label>Valore immobilizzazioni materiali e immateriali (‚Ç¨):</label>
                    <input type="number" id="bImmobilizzazioni" step="1000" min="0" onchange="calcolaPunteggio()">
                </div>
                <div class="alert">
                    <strong>‚ö†Ô∏è Attenzione:</strong> Inserire il valore delle immobilizzazioni AL NETTO degli investimenti destinati all'immobile (ristrutturazione, rifacimenti, etc.)
                </div>
            </div>

            <!-- Criterio C: Risultati Economici Attesi -->
            <div class="criterion" id="criterionC" style="display:none;">
                <div class="criterion-header">
                    <h3>C) Risultati Economici Attesi</h3>
                    <span class="max-points">Max 14 punti</span>
                    <span class="criterion-score" id="scoreC">0 punti</span>
                </div>

                <div class="stato-impresa">
                    <h3>Stato dell'impresa</h3>
                    <div class="stato-buttons">
                        <label>
                            <input type="radio" name="statoImpresaC" value="inattiva" onchange="aggiornaVisibilitaSottocriteri(); calcolaPunteggio();">
                            <span>Impresa Inattiva</span>
                        </label>
                        <label>
                            <input type="radio" name="statoImpresaC" value="attiva" onchange="aggiornaVisibilitaSottocriteri(); calcolaPunteggio();">
                            <span>Impresa Attiva</span>
                        </label>
                    </div>
                </div>

                <!-- C1: ROS -->
                <div class="sub-criterion">
                    <h4>C1) ROS - Return on Sales (max 4 punti)</h4>
                    
                    <div id="c1Inattiva" style="display:none;">
                        <div class="input-group">
                            <label>ROS anno a regime (%):</label>
                            <input type="number" id="c1InattivaROS" step="0.1" min="0" max="100" onchange="calcolaPunteggio()">
                        </div>
                    </div>

                    <div id="c1Attiva" style="display:none;">
                        <div class="input-group">
                            <label>Incremento ROS (anno a regime - anno precedente) (%):</label>
                            <input type="number" id="c1AttivaIncremento" step="0.1" onchange="calcolaPunteggio()">
                        </div>
                    </div>
                </div>

                <!-- C2: ROI -->
                <div class="sub-criterion">
                    <h4>C2) ROI - Return on Investment (max 4 punti)</h4>
                    
                    <div id="c2Inattiva" style="display:none;">
                        <div class="input-group">
                            <label>ROI anno a regime (%):</label>
                            <input type="number" id="c2InattivaROI" step="0.1" min="0" max="100" onchange="calcolaPunteggio()">
                        </div>
                    </div>

                    <div id="c2Attiva" style="display:none;">
                        <div class="input-group">
                            <label>Incremento ROI (anno a regime - anno precedente) (%):</label>
                            <input type="number" id="c2AttivaIncremento" step="0.1" onchange="calcolaPunteggio()">
                        </div>
                    </div>
                </div>

                <!-- C3: EBITDA Margin -->
                <div class="sub-criterion">
                    <h4>C3) EBITDA Margin (max 4 punti)</h4>
                    
                    <div id="c3Inattiva" style="display:none;">
                        <div class="input-group">
                            <label>EBITDA Margin anno a regime (%):</label>
                            <input type="number" id="c3InattivaEBITDA" step="0.1" min="0" max="100" onchange="calcolaPunteggio()">
                        </div>
                    </div>

                    <div id="c3Attiva" style="display:none;">
                        <div class="input-group">
                            <label>Incremento EBITDA Margin (anno a regime - anno precedente) (%):</label>
                            <input type="number" id="c3AttivaIncremento" step="0.1" onchange="calcolaPunteggio()">
                        </div>
                    </div>
                </div>

                <!-- C4: Tasso di vendita (solo inattive) -->
                <div class="sub-criterion" id="c4Container" style="display:none;">
                    <h4>C4) Tasso di Vendita - Solo per imprese inattive (max 4 punti)</h4>
                    <div class="input-group">
                        <label>Percentuale servizi erogati rispetto alla capacit√† massima (%):</label>
                        <input type="number" id="c4TassoVendita" step="0.1" min="0" max="100" onchange="calcolaPunteggio()">
                    </div>
                </div>
            </div>

            <!-- Criterio D: Qualit√† Progettuale -->
            <div class="criterion" id="criterionD" style="display:none;">
                <div class="criterion-header">
                    <h3>D) Qualit√† Progettuale</h3>
                    <span class="max-points">Max 17 punti</span>
                    <span class="criterion-score" id="scoreD">0 punti</span>
                </div>

                <!-- D1: Tipo di Intervento -->
                <div class="sub-criterion">
                    <h4>D1) Tipo di Intervento di Ristrutturazione (max 10 punti)</h4>
                    
                    <div class="option-group">
                        <label>
                            <input type="radio" name="d1Intervento" value="nessuno" onchange="calcolaPunteggio()">
                            Nessun intervento e/o manutenzione ordinaria (0 punti)
                        </label>
                    </div>
                    
                    <div class="option-group">
                        <label>
                            <input type="radio" name="d1Intervento" value="straordinaria" onchange="calcolaPunteggio()">
                            Manutenzione straordinaria comprensiva di eventuali ampliamenti senza consumo di suolo (7 punti)
                        </label>
                    </div>
                    
                    <div class="option-group">
                        <label>
                            <input type="radio" name="d1Intervento" value="recupero" onchange="calcolaPunteggio()">
                            Recupero e completamento, con possibilit√† di demolizione e/o ricostruzione anche parziale con possibili ampliamenti senza consumo di suolo (7 punti)
                        </label>
                    </div>
                    
                    <div class="option-group">
                        <label>
                            <input type="radio" name="d1Intervento" value="ristrutturazione" onchange="calcolaPunteggio()">
                            Ristrutturazione e/o risanamento conservativo (10 punti)
                        </label>
                    </div>
                </div>

                <!-- D2: Immobili di interesse storico -->
                <div class="sub-criterion">
                    <h4>D2) Interventi su Immobili di Interesse Storico-Culturale (max 7 punti)</h4>
                    
                    <div class="option-group">
                        <label>
                            <input type="radio" name="d2Storico" value="nessuno" onchange="calcolaPunteggio()">
                            Nessun intervento (0 punti)
                        </label>
                    </div>
                    
                    <div class="option-group">
                        <label>
                            <input type="radio" name="d2Storico" value="straordinaria" onchange="calcolaPunteggio()">
                            Manutenzione straordinaria (rifacimento coperture, facciate, etc.) (3 punti)
                        </label>
                    </div>
                    
                    <div class="option-group">
                        <label>
                            <input type="radio" name="d2Storico" value="recupero" onchange="calcolaPunteggio()">
                            Recupero e completamento opere edilizie (5 punti)
                        </label>
                    </div>
                    
                    <div class="option-group">
                        <label>
                            <input type="radio" name="d2Storico" value="restauro" onchange="calcolaPunteggio()">
                            Restauro attraverso azioni di risanamento conservativo (7 punti)
                        </label>
                    </div>
                </div>

                <!-- D3: Efficienza della spesa -->
                <div class="sub-criterion">
                    <h4>D3) Rapporto tra Preventivi e Programma di Spesa (max 10 punti)</h4>
                    
                    <div class="input-group">
                        <label>Valore delle voci di costo con preventivi (‚Ç¨):</label>
                        <input type="number" id="d3ValorePreventivi" step="1000" min="0" onchange="calcolaPunteggio()">
                    </div>
                    
                    <div class="input-group">
                        <label>Valore complessivo programma di spesa (‚Ç¨):</label>
                        <input type="number" id="d3ProgrammaSpesa" step="1000" min="0" onchange="calcolaPunteggio()">
                    </div>
                </div>
            </div>

            <!-- Criterio E: Sostenibilit√† Ambientale -->
            <div class="criterion" id="criterionE" style="display:none;">
                <div class="criterion-header">
                    <h3>E) Rilevanza del Progetto - Sostenibilit√† Ambientale</h3>
                    <span class="max-points">Max 17 punti</span>
                    <span class="criterion-score" id="scoreE">0 punti</span>
                </div>

                <div class="alert alert-info">
                    <strong>‚úì I punteggi sono CUMULABILI</strong> - Puoi selezionare pi√π interventi
                </div>

                <div class="checkbox-group">
                    <label>
                        <input type="checkbox" name="e1" value="2" onchange="calcolaPunteggio()">
                        Impianti di recupero acque meteoriche (2 punti)
                    </label>
                </div>

                <div class="checkbox-group">
                    <label>
                        <input type="checkbox" name="e2" value="2" onchange="calcolaPunteggio()">
                        Relamping con tecnologia LED (2 punti)
                    </label>
                </div>

                <div class="checkbox-group">
                    <label>
                        <input type="checkbox" name="e3" value="3" onchange="calcolaPunteggio()">
                        Impianti di gestione domotica (irrigazione, illuminazione, etc.) (3 punti)
                    </label>
                </div>

                <div class="checkbox-group">
                    <label>
                        <input type="checkbox" name="e4" value="3" onchange="calcolaPunteggio()">
                        Produzione acqua calda sanitaria con solare termico (3 punti)
                    </label>
                </div>

                <div class="checkbox-group">
                    <label>
                        <input type="checkbox" name="e5" value="3" onchange="calcolaPunteggio()">
                        Miglioramento prestazioni termiche involucro edilizio (cappotto, serramenti, etc.) (3 punti)
                    </label>
                </div>

                <div class="checkbox-group">
                    <label>
                        <input type="checkbox" name="e6" value="4" onchange="calcolaPunteggio()">
                        Impianti fotovoltaici e fotovoltaici con accumulo (4 punti)
                    </label>
                </div>
            </div>

            <!-- Criterio F: Localizzazione -->
            <div class="criterion" id="criterionF" style="display:none;">
                <div class="criterion-header">
                    <h3>F) Localizzazione del Progetto</h3>
                    <span class="max-points">Max 10 punti</span>
                    <span class="criterion-score" id="scoreF">0 punti</span>
                </div>

                <div class="option-group">
                    <label>
                        <input type="radio" name="fLocalizzazione" value="0" onchange="calcolaPunteggio()">
                        Intervento non ricadente nelle aree specificate (0 punti)
                    </label>
                </div>

                <div class="option-group">
                    <label>
                        <input type="radio" name="fLocalizzazione" value="4" onchange="calcolaPunteggio()">
                        Intervento ricadente in un'area specificata (rurale O isola minore O marginalit√† ricettiva) (4 punti)
                    </label>
                </div>

                <div class="option-group">
                    <label>
                        <input type="radio" name="fLocalizzazione" value="8" onchange="calcolaPunteggio()">
                        Intervento ricadente in almeno due aree specificate (8 punti)
                    </label>
                </div>

                <div class="option-group">
                    <label>
                        <input type="radio" name="fLocalizzazione" value="10" onchange="calcolaPunteggio()">
                        Intervento ricadente nelle tre aree specificate (rurale E isola minore E marginalit√† ricettiva) (10 punti)
                    </label>
                </div>

                <div class="alert">
                    <strong>üìç Definizioni:</strong><br>
                    ‚Ä¢ <strong>Aree rurali:</strong> comuni con densit√† < 150 ab/km¬≤<br>
                    ‚Ä¢ <strong>Isole minori:</strong> isole minori siciliane<br>
                    ‚Ä¢ <strong>Marginalit√† ricettiva:</strong> comuni con rapporto posti letto/superficie inferiore alla media regionale
                </div>
            </div>

            <button class="reset-button" onclick="resetForm()">üîÑ Azzera e Ricomincia</button>
        </div>

        <div class="footer">
            <p><strong>Regione Siciliana - Assessorato del Turismo, dello Sport e dello Spettacolo</strong></p>
            <p>FSC 2021-2027 - Area Tematica 03 Competitivit√† Imprese - Linea 03.02 Turismo e Ospitalit√†</p>
            <p style="margin-top: 10px; font-size: 0.9em;">D.D.G. n. 2139/S11 del 26.06.2025</p>
        </div>
    </div>

    <script>
        // Funzione per aggiornare la visibilit√† dei criteri in base al regime selezionato
        function aggiornaVisibilitaCriteri() {
            const regime = document.querySelector('input[name="regime"]:checked')?.value;
            
            if (!regime) {
                // Nascondi tutti i criteri se non √® selezionato alcun regime
                document.querySelectorAll('.criterion').forEach(c => c.style.display = 'none');
                return;
            }

            // Mostra tutti i criteri
            document.getElementById('criterionA').style.display = 'block';
            document.getElementById('criterionB').style.display = 'block';
            document.getElementById('criterionC').style.display = 'block';
            document.getElementById('criterionD').style.display = 'block';
            document.getElementById('criterionE').style.display = 'block';
            document.getElementById('criterionF').style.display = 'block';

            calcolaPunteggio();
        }

        // Funzione per aggiornare la visibilit√† dei sottocriteri in base allo stato dell'impresa
        function aggiornaVisibilitaSottocriteri() {
            // Criterio A
            const statoA = document.querySelector('input[name="statoImpresaA"]:checked')?.value;
            document.getElementById('aInattiva').style.display = statoA === 'inattiva' ? 'block' : 'none';
            document.getElementById('aAttiva').style.display = statoA === 'attiva' ? 'block' : 'none';

            // Criterio C
            const statoC = document.querySelector('input[name="statoImpresaC"]:checked')?.value;
            document.getElementById('c1Inattiva').style.display = statoC === 'inattiva' ? 'block' : 'none';
            document.getElementById('c1Attiva').style.display = statoC === 'attiva' ? 'block' : 'none';
            document.getElementById('c2Inattiva').style.display = statoC === 'inattiva' ? 'block' : 'none';
            document.getElementById('c2Attiva').style.display = statoC === 'attiva' ? 'block' : 'none';
            document.getElementById('c3Inattiva').style.display = statoC === 'inattiva' ? 'block' : 'none';
            document.getElementById('c3Attiva').style.display = statoC === 'attiva' ? 'block' : 'none';
            
            // C4 √® solo per inattive
            document.getElementById('c4Container').style.display = statoC === 'inattiva' ? 'block' : 'none';
        }

        // Calcolo Criterio A
        function calcA() {
            const statoA = document.querySelector('input[name="statoImpresaA"]:checked')?.value;
            if (!statoA) return 0;

            if (statoA === 'inattiva') {
                const nuoviOccupati = parseFloat(document.getElementById('aInattivaNuoviOccupati').value) || 0;
                const investimento = parseFloat(document.getElementById('aInattivaInvestimento').value) || 0;
                
                if (investimento === 0) return 0;
                
                const ratio = nuoviOccupati / (investimento / 150000);
                
                if (ratio >= 2) return 6;
                if (ratio >= 1.5) return 4;
                if (ratio >= 1) return 2;
                return 0;
            } else {
                const incrementoOccupati = parseFloat(document.getElementById('aAttivaIncrementoOccupati').value) || 0;
                const investimento = parseFloat(document.getElementById('aAttivaInvestimento').value) || 0;
                
                if (investimento === 0) return 0;
                
                const ratio = incrementoOccupati / (investimento / 350000);
                
                if (ratio >= 2) return 6;
                if (ratio >= 1.5) return 4;
                if (ratio >= 1) return 2;
                return 0;
            }
        }

        // Calcolo Criterio B
        function calcB() {
            const investimentoTotale = parseFloat(document.getElementById('bInvestimentoTotale').value) || 0;
            const immobilizzazioni = parseFloat(document.getElementById('bImmobilizzazioni').value) || 0;
            
            if (investimentoTotale === 0) return 0;
            
            const ratio = immobilizzazioni / investimentoTotale;
            
            if (ratio <= 1.5) return 20;
            if (ratio <= 2.0) return 16;
            if (ratio <= 2.5) return 10;
            if (ratio <= 3.0) return 7;
            return 0;
        }

        // Calcolo Criterio C
        function calcC() {
            let total = 0;
            const statoC = document.querySelector('input[name="statoImpresaC"]:checked')?.value;
            if (!statoC) return 0;

            // C1: ROS
            if (statoC === 'inattiva') {
                const ros = parseFloat(document.getElementById('c1InattivaROS').value) || 0;
                if (ros > 20) total += 4;
                else if (ros >= 10) total += 2;
            } else {
                const incremento = parseFloat(document.getElementById('c1AttivaIncremento').value) || 0;
                if (incremento > 10) total += 4;
                else if (incremento >= 5) total += 2;
            }

            // C2: ROI
            if (statoC === 'inattiva') {
                const roi = parseFloat(document.getElementById('c2InattivaROI').value) || 0;
                if (roi > 15) total += 4;
                else if (roi >= 5) total += 2;
            } else {
                const incremento = parseFloat(document.getElementById('c2AttivaIncremento').value) || 0;
                if (incremento > 10) total += 4;
                else if (incremento >= 5) total += 2;
            }

            // C3: EBITDA
            if (statoC === 'inattiva') {
                const ebitda = parseFloat(document.getElementById('c3InattivaEBITDA').value) || 0;
                if (ebitda > 30) total += 4;
                else if (ebitda >= 15) total += 2;
            } else {
                const incremento = parseFloat(document.getElementById('c3AttivaIncremento').value) || 0;
                if (incremento > 20) total += 4;
                else if (incremento >= 8) total += 2;
            }

            // C4: Tasso di vendita (solo inattive)
            if (statoC === 'inattiva') {
                const tasso = parseFloat(document.getElementById('c4TassoVendita').value) || 0;
                if (tasso > 70) total += 4;
                else if (tasso >= 50) total += 2;
            }

            return total;
        }

        // Calcolo Criterio D
        function calcD() {
            let total = 0;

            // D1: Tipo di intervento
            const d1 = document.querySelector('input[name="d1Intervento"]:checked')?.value;
            if (d1 === 'straordinaria') total += 7;
            if (d1 === 'recupero') total += 7;
            if (d1 === 'ristrutturazione') total += 10;

            // D2: Immobili storici
            const d2 = document.querySelector('input[name="d2Storico"]:checked')?.value;
            if (d2 === 'straordinaria') total += 3;
            if (d2 === 'recupero') total += 5;
            if (d2 === 'restauro') total += 7;

            // D3: Efficienza della spesa
            const valorePreventivi = parseFloat(document.getElementById('d3ValorePreventivi').value) || 0;
            const programmaSpesa = parseFloat(document.getElementById('d3ProgrammaSpesa').value) || 0;
            
            if (programmaSpesa > 0) {
                const ratio = valorePreventivi / programmaSpesa;
                if (ratio > 0.85) total += 10;
                else if (ratio > 0.70) total += 8;
                else if (ratio > 0.55) total += 6;
                else if (ratio > 0.40) total += 4;
            }

            return Math.min(total, 17); // Max 17 punti
        }

        // Calcolo Criterio E
        function calcE() {
            let total = 0;
            const checkboxes = document.querySelectorAll('[name^="e"]:checked');
            checkboxes.forEach(cb => {
                total += parseInt(cb.value);
            });
            return Math.min(total, 17); // Max 17 punti (tutti gli interventi)
        }

        // Calcolo Criterio F
        function calcF() {
            const value = document.querySelector('input[name="fLocalizzazione"]:checked')?.value;
            return value ? parseInt(value) : 0;
        }

        // Calcolo punteggio totale
        function calcolaPunteggio() {
            const regime = document.querySelector('input[name="regime"]:checked')?.value;
            if (!regime) {
                document.getElementById('totalScore').textContent = '0 / 100';
                return;
            }

            const scoreA = calcA();
            const scoreB = calcB();
            const scoreC = calcC();
            const scoreD = calcD();
            const scoreE = calcE();
            const scoreF = calcF();

            const total = scoreA + scoreB + scoreC + scoreD + scoreE + scoreF;

            document.getElementById('scoreA').textContent = scoreA + ' punti';
            document.getElementById('scoreB').textContent = scoreB + ' punti';
            document.getElementById('scoreC').textContent = scoreC + ' punti';
            document.getElementById('scoreD').textContent = scoreD + ' punti';
            document.getElementById('scoreE').textContent = scoreE + ' punti';
            document.getElementById('scoreF').textContent = scoreF + ' punti';
            document.getElementById('totalScore').textContent = total + ' / 100';
        }

        // Reset del form
        function resetForm() {
            if (confirm('Sei sicuro di voler azzerare tutti i dati inseriti?')) {
                document.querySelectorAll('input').forEach(input => {
                    if (input.type === 'radio' || input.type === 'checkbox') {
                        input.checked = false;
                    } else {
                        input.value = '';
                    }
                });
                
                document.querySelectorAll('.criterion').forEach(c => c.style.display = 'none');
                calcolaPunteggio();
            }
        }

        // Inizializzazione
        document.addEventListener('DOMContentLoaded', function() {
            calcolaPunteggio();
        });
    </script>
</body>
</html>
